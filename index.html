<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>RNG Fish It - Secret Update</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #f8fafc;
        --card: #ffffff;
        --muted: #64748b;
        --accent: #0ea5e9; /* Sky blue accent */
        --accent-dark: #0284c7;
        --glass: rgba(14, 165, 233, 0.08);
      }
      body {
        background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%);
        color: #0f172a;
        font-family: Inter, system-ui, -apple-system, sans-serif;
      }
      .card-modern {
        background: var(--card);
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(15, 23, 42, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.5);
      }
      .form-select,
      .form-control {
        border-radius: 10px;
        border: 1px solid #cbd5e1;
        padding: 0.6rem 0.8rem;
      }
      .form-select:focus,
      .form-control:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px var(--glass);
      }
      .small-muted {
        color: var(--muted);
        font-size: 0.85rem;
      }
      .result-value {
        font-weight: 800;
        color: #0f172a;
        font-size: 1.1rem;
      }
      .mono {
        font-family: "JetBrains Mono", ui-monospace, monospace;
      }
      .accent-btn {
        background: linear-gradient(135deg, var(--accent), var(--accent-dark));
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 12px;
        font-weight: 600;
        transition: all 0.2s;
      }
      .accent-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
      }
      .accent-btn:active {
        transform: translateY(1px);
      }
      .badge-custom {
        background: var(--glass);
        color: var(--accent-dark);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="card-modern p-4 mb-4">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h2 class="mb-1 fw-bold">üé£ RNG Fish It</h2>
                <div class="small-muted">
                  Kalkulator Estimasi (Secret Fish & New Enchants)
                </div>
              </div>
              <div class="text-end d-none d-sm-block">
                <span class="badge-custom">Updated: Secret/Shark/Stargazer</span>
              </div>
            </div>
          </div>

          <div class="card-modern p-4 mb-4">
            <form id="calcForm" onsubmit="return false;">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-semibold">Target (Secret Rarity)</label>
                  <select id="fish" class="form-select">
                    <optgroup label="Fisherman Island">
                      <option value="750000">Crystal Crab ‚Äî 1/750K</option>
                      <option value="1500000">Orca ‚Äî 1/1.5M</option>
                    </optgroup>

                    <optgroup label="Ocean">
                      <option value="250000">Blob Shark ‚Äî 1/250K</option>
                      <option value="500000">Ghost Shark ‚Äî 1/500K</option>
                      <option value="3000000">Worm Fish ‚Äî 1/3M</option>
                    </optgroup>

                    <optgroup label="Kohana">
                      <option value="3000000">Lochnes Monster ‚Äî 1/3M</option>
                    </optgroup>

                    <optgroup label="Coral Reefs">
                      <option value="250000">Eerie Shark ‚Äî 1/250K</option>
                      <option value="2500000">Monster Shark ‚Äî 1/2.5M</option>
                    </optgroup>

                    <optgroup label="Esoteric Depths">
                      <option value="300000">Thin Armor Shark ‚Äî 1/300K</option>
                      <option value="3000000">Scare ‚Äî 1/3M</option>
                    </optgroup>

                    <optgroup label="Tropical Grove">
                      <option value="950000">Great Whale ‚Äî 1/950K</option>
                    </optgroup>

                    <optgroup label="Crater Island">
                      <option value="500000">Frostborn Shark ‚Äî 1/500K</option>
                    </optgroup>

                    <optgroup label="Treasure Room - Lost Isle">
                      <option value="800000">Queen Crab ‚Äî 1/800K</option>
                      <option value="1200000">King Crab ‚Äî 1/1.2M</option>
                    </optgroup>

                    <optgroup label="Sisyphus Statue - Lost Isle">
                      <option value="750000">Panther Eel ‚Äî 1/750K</option>
                      <option value="800000">Giant Squid ‚Äî 1/800K</option>
                      <option value="3500000">Robot Kraken ‚Äî 1/3.5M</option>
                    </optgroup>

                    <optgroup label="Admin Event Ocean">
                      <option value="1000000">Ghost Worm Fish ‚Äî 1/1M</option>
                      <option value="4000000">Megalodon ‚Äî 1/4M</option>
                    </optgroup>

                    <optgroup label="Ancient Jungle">
                      <option value="1500000">King Jelly ‚Äî 1/1.5M</option>
                      <option value="800000">Mosasaurus Shark ‚Äî 1/800K</option>
                    </optgroup>

                    <optgroup label="Ancient Jungle - Sacred Temple">
                      <option value="4000000">Elshark Grand Maja ‚Äî 1/4M</option>
                      <option value="2000000">Bone Whale ‚Äî 1/2M</option>
                    </optgroup>
                    
                    <optgroup label="Ancient Jungle - Underground Cellar">
                      <option value="2000000">Bone Whale ‚Äî 1/2M</option>
                    </optgroup>
                  </select>
                </div>

                <div class="col-md-6">
                  <label class="form-label fw-semibold">Rod</label>
                  <select id="rod" class="form-select">
                    <option value="380">Hazmat Rod (380%)</option>
                    <option value="455">Ares Rod (455%)</option>
                    <option value="530">Angler Rod (530%)</option>
                    <option value="610">Ghostfinn Rod (610%)</option>
                    <option value="760">Bamboo Rod (760%)</option>
                    <option value="1111" selected>Element Rod (1111%)</option>
                  </select>
                </div>

                <div class="col-md-6">
                  <label class="form-label fw-semibold">Bait</label>
                  <select id="bobber" class="form-select">
                    <option value="130">Royal Bait (+130%)</option>
                    <option value="170">Dark Matter Bait (+170%)</option>
                    <option value="220">Corrupt Bait (+220%)</option>
                    <option value="260">Aether Bait (+260%)</option>
                    <option value="320">Floral Bait (+320%)</option>
                    <option value="380" selected>Singularity Bait (+380%)</option>
                  </select>
                </div>

                <div class="col-md-6">
                  <label class="form-label fw-semibold">Enchant #1</label>
                  <select id="ench1" class="form-select">
                    <option value="0">None</option>
                    <optgroup label="üî• New & Meta">
                      <option value="140">Secret Hunter (+140% Secret Chance)</option>
                      <option value="140">Stormhunter II (+140% Rain Luck)</option>
                      <option value="100">Stargazer II (+100% Night Luck)</option>
                      <option value="60" data-cond="shark">Shark Hunter (+60% Shark Chance)</option>
                    </optgroup>
                    <optgroup label="üçÄ Standard Luck">
                      <option value="30">Leprechaun I (+30%)</option>
                      <option value="50">Leprechaun II (+50%)</option>
                      <option value="3800">Prismatic I (+3800% Active)</option>
                    </optgroup>
                    <optgroup label="üß¨ Mutation/Utility">
                       <option value="0" data-mutation="40">Mutation Hunter III (+40% Mut)</option>
                       <option value="0" data-mutation="20">Fairy Hunter (+20% Fairy Dust)</option>
                       <option value="-75" data-mutation="75">Cursed I (-75% Luck, +75% Mut)</option>
                       <option value="0">Reeler II (+15% Speed)</option>
                    </optgroup>
                  </select>
                </div>

                <div class="col-md-6">
                  <label class="form-label fw-semibold">Enchant #2</label>
                  <select id="ench2" class="form-select">
                    <option value="0">None</option>
                    <optgroup label="üî• New & Meta">
                      <option value="140">Secret Hunter (+140% Secret Chance)</option>
                      <option value="140">Stormhunter II (+140% Rain Luck)</option>
                      <option value="100">Stargazer II (+100% Night Luck)</option>
                      <option value="60" data-cond="shark">Shark Hunter (+60% Shark Chance)</option>
                    </optgroup>
                    <optgroup label="üçÄ Standard Luck">
                      <option value="30">Leprechaun I (+30%)</option>
                      <option value="50">Leprechaun II (+50%)</option>
                      <option value="3800">Prismatic I (+3800% Active)</option>
                    </optgroup>
                    <optgroup label="üß¨ Mutation/Utility">
                       <option value="0" data-mutation="40">Mutation Hunter III (+40% Mut)</option>
                       <option value="0" data-mutation="20">Fairy Hunter (+20% Fairy Dust)</option>
                       <option value="-75" data-mutation="75">Cursed I (-75% Luck, +75% Mut)</option>
                       <option value="0">Reeler II (+15% Speed)</option>
                    </optgroup>
                  </select>
                </div>

                <div class="col-md-4">
                  <label class="form-label fw-semibold">Extra Luck (%)</label>
                  <input id="extra" type="number" class="form-control" placeholder="0" />
                </div>

                <div class="col-md-4">
                  <label class="form-label fw-semibold">Lemparan / Hari</label>
                  <input id="throwsPerDay" type="number" class="form-control" value="5000" />
                </div>

                <div class="col-md-4 d-flex align-items-end">
                  <button id="btnCalc" class="btn accent-btn w-100 shadow-sm">
                    üîç Hitung Peluang
                  </button>
                </div>
              </div>
            </form>
          </div>

          <div id="resultCard" class="card-modern p-4 d-none">
            <h5 class="mb-3 fw-bold border-bottom pb-2">üìä Hasil Analisa</h5>
            
            <div class="row g-3 mb-4 text-center">
              <div class="col-6 col-md-3">
                <div class="small-muted mb-1">Total Luck</div>
                <div class="result-value mono" id="outLuck">0%</div>
              </div>
              <div class="col-6 col-md-3">
                <div class="small-muted mb-1">Peluang / Lempar</div>
                <div class="result-value mono text-primary" id="outPerThrow">0%</div>
              </div>
              <div class="col-6 col-md-3">
                <div class="small-muted mb-1">Lemparan (50%)</div>
                <div class="result-value mono" id="outN50">0</div>
              </div>
              <div class="col-6 col-md-3">
                <div class="small-muted mb-1">Estimasi Waktu</div>
                <div class="result-value mono" id="outHours50">0 Jam</div>
              </div>
            </div>

            <div class="table-responsive bg-white rounded-3 border p-2 mb-3">
              <table class="table table-sm table-borderless mb-0">
                <thead class="text-muted border-bottom">
                  <tr>
                    <th>Probability</th>
                    <th>Lemparan Dibutuhkan</th>
                    <th>Waktu (Hari/Jam)</th>
                  </tr>
                </thead>
                <tbody id="progressTable"></tbody>
              </table>
            </div>

            <div class="alert alert-light border small-muted mb-0">
              <strong>Info:</strong> <span id="outNotes"></span>
            </div>
          </div>

        </div>
      </div>
    </div>

    <script>
      // Helpers
      const fmt = n => Math.round(n).toLocaleString();
      const hoursToDays = h => {
        if (!isFinite(h)) return "Selamanya";
        if (h < 24) return h.toFixed(1) + " Jam";
        const d = h / 24;
        return d.toFixed(1) + " Hari (" + Math.round(h) + " jam)";
      };

      document.getElementById("btnCalc").addEventListener("click", () => {
        // 1. Get Values
        const fishEl = document.getElementById("fish");
        const rarity = Number(fishEl.value);
        const fishName = fishEl.options[fishEl.selectedIndex].text.toLowerCase();
        
        const rod = Number(document.getElementById("rod").value);
        const bobber = Number(document.getElementById("bobber").value);
        const extra = Number(document.getElementById("extra").value || 0);
        const throwsPerDay = Number(document.getElementById("throwsPerDay").value || 1);

        // 2. Process Enchants
        const processEnchant = (id) => {
          const el = document.getElementById(id);
          const opt = el.selectedOptions[0];
          let val = Number(el.value);
          const mut = Number(opt.getAttribute('data-mutation') || 0);
          const cond = opt.getAttribute('data-cond');

          // Logic Shark Hunter: Cek nama ikan
          if (cond === 'shark') {
            const isShark = fishName.includes('shark') || fishName.includes('megalodon');
            if (!isShark) val = 0; // Disable bonus if not shark
          }

          return { val, mut, text: opt.text };
        };

        const e1 = processEnchant('ench1');
        const e2 = processEnchant('ench2');

        // 3. Totals
        const totalLuck = rod + bobber + e1.val + e2.val + extra;
        const totalMut = e1.mut + e2.mut;
        
        // 4. Probability Math (Linear New RNG)
        // Prob = Base * (1 + Luck/100)
        const pBase = 1 / rarity;
        const multiplier = 1 + (totalLuck / 100);
        let p = pBase * multiplier;
        if (p > 1) p = 1;

        // 5. Calc 50%
        let n50 = (p > 0) ? Math.log(0.5) / Math.log(1 - p) : Infinity;
        let h50 = (n50 === Infinity) ? Infinity : (n50 / (throwsPerDay/24));

        // 6. Render Summary
        document.getElementById("outLuck").textContent = totalLuck.toLocaleString() + "%";
        document.getElementById("outPerThrow").textContent = (p * 100).toFixed(6) + "%";
        document.getElementById("outN50").textContent = (n50 === Infinity) ? "‚àû" : fmt(n50);
        document.getElementById("outHours50").textContent = hoursToDays(h50);

        // 7. Render Table (10% to 99.9%)
        const table = document.getElementById("progressTable");
        table.innerHTML = "";
        const steps = [10, 50, 75, 90, 99, 99.9];
        
        steps.forEach(pct => {
          const targetP = pct / 100;
          let throws = (p > 0) ? Math.log(1 - targetP) / Math.log(1 - p) : Infinity;
          let hours = (throws === Infinity) ? Infinity : (throws / (throwsPerDay/24));
          
          let row = `
            <tr>
              <td class="fw-bold text-muted">${pct}%</td>
              <td class="mono">${(throws === Infinity) ? "‚àû" : fmt(throws)}</td>
              <td class="mono">${hoursToDays(hours)}</td>
            </tr>
          `;
          table.innerHTML += row;
        });

        // 8. Notes logic
        let notes = [];
        if (e1.text.includes("Shark") && e1.val === 0) notes.push("Shark Hunter tidak aktif (bukan Hiu).");
        if (e2.text.includes("Shark") && e2.val === 0) notes.push("Shark Hunter tidak aktif (bukan Hiu).");
        if (totalMut > 0) notes.push(`Mutation Chance +${totalMut}%.`);
        if (fishName.includes("secret") || true) notes.push("Daftar ikan Secret (Secret Hunter efektif).");
        
        document.getElementById("outNotes").textContent = notes.join(" ") || "Normal calculation.";
        document.getElementById("resultCard").classList.remove("d-none");
        document.getElementById("resultCard").scrollIntoView({behavior: "smooth", block: "center"});
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
